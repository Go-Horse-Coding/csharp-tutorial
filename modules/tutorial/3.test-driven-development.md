# 3. Desenvolvimento Dirigido a Testes

Agora com o nossa **solution** criada, vamos criar testes para cada comando e suas regras de nosso programa. <br/>
Inicialmente esses testes vão falhar, mas eles vão ser o nosso guia para sabermos se estamos fazendo a implementação correta.

## Criando um projeto de testes

1. Clicando com o botão direito em sua **solution**, vá em **add/new project...**;

<div align="center">
	<img src="/images/tutorial/3.step-1.png" alt="Create New Project" width="650" /> 
</div>

2. Selecione **xUnit Test Project (.NET Core)**;
3. Coloque **CSharpTutorialTests** como o nome do projeto e **clique em criar**;
4. Após criado o projeto de testes, delete o arquivo **UnitTest1.cs**.

## Criando os testes

Com o botão direito em **CSharpTutorialTests**, vá em **add/New Item** e coloque o nome de **MachineTests**.

Sua classe **MachineTests.cs** deve estar assim:
```C#
using System;
using System.Collections.Generic;
using System.Text;

namespace CSharpTutorialTests
{
    public class MachineTests
    {
    }
}
```

Vamos agora fazer testes para testar cada uma das funcionalidades de nossa máquina.

### Teste comando número

O teste deve verificar se um número digitado é adicionado na pilha.
Adicione a seguinte função a sua classe **MachineTests.cs**

```C#
[Fact]
public void EnterCommand_WhenNumber_ShouldAddToStack()
{
	Machine machine = new Machine();

	machine.EnterCommand("5");

	Assert.Equal(5, machine.Top());
}
```

Perceba que o nosso teste está dando erro. 
Devido as regras passadas, conclui que nossa **Machine** deverá ter uma forma de receber os comandos, <br/>
foi então que nasceu a função **EnterCommand(string command)**. Ao mesmo tempo, para testar, preciso saber qual o número
que se encontra no topo da pilha, para isso agora existe o **Top()**.
 
<br/>
 
No T.D.D. (Testes Dirigidos ao Desenvolvimento ou Test Driven Design em inglês) os testes são escritos antes da implementação.
Isso nos obriga a fazer a implementação de forma que os testes passem.

Vamos adicionar mais alguns testes antes de começar a implementação:

```C#
[Fact]
public void EnterCommand_WhenNegativeNumber_ShouldThrowError()
{
	Machine machine = new Machine();

	Assert.Throws<MachineException>(() => machine.EnterCommand("-5");)
}

[Fact]
public void EnterCommand_WhenNumberGreaterThan999_ShouldThrowError()
{
	Machine machine = new Machine();

	Assert.Throws<MachineException>(() => machine.EnterCommand("999");)
}

[Fact]
public void EnterCommand_WhenStackFull_ShouldThrowError()
{
	Machine machine = new Machine();

	Assert.Throws<MachineException>(() =>
	{
		for (int i = 0; i < 11; i ++)
		{
			machine.EnterCommand("5");
		}
	});
}
``` 


